<!DOCTYPE html>
<html><head>
<title>Calculatrice simple pour algèbre linéaire</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="Adaptation, avec permision, de MathCortex.com .">
<meta name="Author" content="Gorkem Gencay (modifié, avec permission, par André Roberge)">

<script type="text/javascript" src="mathcortex/jquery-1.js"></script>
<link rel="stylesheet" type="text/css" href="mathcortex/style.css" media="all">
<link rel="stylesheet" type="text/css" href="mathcortex/ace.css" media="all">

<script src="mathcortex/parser_funcs.js"></script>
<script src="mathcortex/parser_type.js"></script>
<script src="mathcortex/asm_js.js"></script>
<script src="mathcortex/numeric-1.js"></script>
<script src="mathcortex/algorithms.js"></script>
<script src="mathcortex/test.js"></script>
<script src="mathcortex/gui.js"></script>
<script src="mathcortex/ace.js"></script>
<script src="mathcortex/pages.js"></script>


<script>

function codeUri(code)
{
	var coded = '';
	for( var i = 0; i < code.length; i++)
	{
		switch ( code[i] )
		{
			case ' ': coded += '_';
			break;
			case '_': coded += ' ';
			break;
			case ',': coded += 'l';
			break;
			case 'l': coded += ',';
			break;
			case '=': coded += '~';
			break;
			case '~': coded += '=';
			break;
			case '!': coded += '\n';
			break;
			case '\n': coded += '!';
			break;
			case ';': coded += '-';
			break;
			case '-': coded += ';';
			break;
			default:
				coded += code[i];
		}
	}

	return coded;
}

function checkURIVariables() {
  var query = window.location.hash.substring(1);
  window.location.hash = "";
  var vars = query.split("&");
  var cmd, code;
  for (var i=0;i<vars.length;i++) {
    var pair = vars[i].split("=");
	switch( pair[0])
	{
		case 'cmd':
			cmd = decodeURIComponent(pair[1]);
			break;
		case 'code':
			code = codeUri(decodeURIComponent(pair[1]));
			break;
	}
  }

  return {cmd : cmd, code : code};
}

$(document).click(function(e) {
	var share_elm = $("#link_win");
	if(e.target.id != "share_btn" && e.target.id != "link_input" && e.target.id != "link_win")
	   share_elm.fadeOut('fast');
});

function on_tutorial_change(txt)
{
if (txt=="bas_exp")
	return "a = 4 + sin(pi / 6) * cos(pi / 4);";
var r = document.getElementById(txt).textContent;
if (r===undefined)
{
	r = document.getElementById(txt).innerText;
}
return r;
}

function toggle_anim( cur,nx )
{
	if( nx.css('display') == 'none')
	{
		nx.fadeIn('fast');
		if (cur)
			cur.css("color","red");
	}
	else
	{
		nx.fadeOut('fast');
		if (cur)
			cur.css("color","blue");
	}
}

var ace_editor;
function on_load_page()
{

    $('.infolink').click(function(){
		var nx = $(this).next('.expandable');
		toggle_anim($(this),nx);
    });

	$('#about2').click(function(){
		var nx = $(this).next('.header_link_exp');
		toggle_anim($(this),nx);
    });

	document.getElementById("command_win").onkeydown=cmd_on_key;

	$("#dirselect").keyup(function(event){
		if(event.keyCode == 13){
			changedir($("#dirselect").val());
		}
	});

	document.getElementById("code_txt").onkeydown = on_code_text_change;
	document.getElementById("code_txt").onchange = on_code_text_change;
	document.getElementById("code_txt").oninput = on_code_text_change;

	var queryVar = checkURIVariables();

	if(typeof(Storage)!=="undefined" && localStorage)
	{
		history_on_load();
	}

	if (queryVar.code)
	{
		OpenPageText(queryVar.code);
	}

	ace_editor = ace.edit("editor");
	ace_editor.renderer.setShowGutter(false);
	ace_editor.renderer.setShowPrintMargin(false);
	ace_editor.getSession().on('change', function(){ on_code_text_change()});

	if(typeof(Storage)!=="undefined" && localStorage)
	{
		var i = 0;
		while(localStorage["page_text" + i] !== undefined)
		{
			OpenPageText(localStorage["page_text" + i]);
			i++;
		}

		if (i==0)
			OpenPageText(on_tutorial_change("ex_linsolve"));
	}
	else
	{
		OpenPageText(on_tutorial_change("ex_linsolve"));
	}

	window.onbeforeunload = function(){
		if (localStorage)
		{
			dump_pages_to_localstorage();

		}
	}

	UpdatePagesButtons();
	SelectPage(0);
	toggle_help_col();

	$("#code_txt").keydown(function(e) {
		if(e.keyCode === 9) { // tab was pressed
			// get caret position/selection
			var start = this.selectionStart;
				end = this.selectionEnd;

			var $this = $(this);

			// set textarea value to: text before caret + tab + text after caret
			$this.val($this.val().substring(0, start)
						+ "  "
						+ $this.val().substring(end));

			// put caret at right position again
			this.selectionStart = this.selectionEnd = start + 2;

			// prevent the focus lose
			return false;
		}
	});
};

var saveTimer;
function on_code_text_change()
{
	if( !pages[curpage].isdirty)
	{
		pages[curpage].isdirty = true;
		UpdatePagesButtons();
		SelectPage(curpage);
	}

	pages[curpage].text = pages[curpage].ace_session.getValue();

	if (localStorage)
	{
		if (saveTimer)
			clearTimeout(saveTimer);

		saveTimer = setTimeout(
			function(){

				dump_pages_to_localstorage();
				saveTimer = undefined;
			},1500);
	}

	return true;
}

function dump_pages_to_localstorage()
{
	var ind = 0;
	for(var i=0;i<pages.length;i++)
		if (pages[i].p_id == -1)
		{
			localStorage["page_text" + ind] = pages[i].text;
			ind++;
		}

	localStorage.removeItem("page_text"+ind);
}

function cmd_on_run()
{
	console_print(">> " + document.getElementById('command_win').value);
	add_to_hist(document.getElementById('command_win').value);
	parse_m(document.getElementById('command_win').value, true);
	asm_execute( function(){
		output_last_result();

		document.getElementById('command_win').placeholder = "";
		document.getElementById('command_win').value = "";

		update_editor();
	});
}

function cmd_on_key(e)
{

	var evt=window.event? event : e;
	var keyunicode=evt.charCode || evt.keyCode;

	if (keyunicode==13)
	{
		cmd_on_run();

		return false;
	}
	else if (keyunicode == 40)
	{
		if (history_cur < history_arr.length-1)
		{
			history_cur++;
			document.getElementById('command_win').value = history_arr[history_cur];
		}
		else if (history_cur == history_arr.length-1)
		{
			history_cur++;
			document.getElementById('command_win').value = history_cmd_saved;
		}

	}
	else if (keyunicode == 38)
	{
		if (history_cur == history_arr.length)
		{
			history_cmd_saved = document.getElementById('command_win').value;
		}
		if (history_cur > 0)
		{
			history_cur--;
			document.getElementById('command_win').value = history_arr[history_cur];
		}
	}


	return true;
}

var is_help_col_visible = undefined;
function toggle_help_col()
{
	if(is_help_col_visible === undefined)
	{
		if(typeof(Storage)!=="undefined" && localStorage)
		{
			is_help_col_visible = localStorage["is_help_col_visible"] ? localStorage["is_help_col_visible"] == "true" : true;
		}
		else
			is_help_col_visible = true;
	}
	else
	{
		is_help_col_visible = !is_help_col_visible;
		localStorage["is_help_col_visible"] = is_help_col_visible;
	}

	if (is_help_col_visible)
	{
		$('#leftcol').css('width', '13%');
		$('#middlecol').css('width', '52%');
		$('#leftcontent').fadeIn('fast');
		$('#toggle_help_span').text('}');
	}
	else
	{
		$('#leftcol').css('width', '10px');
		$('#middlecol').css('width', '63%');
		$('#leftcontent').hide();
		$('#toggle_help_span').text('{');
	}
}

var output_window_size = "small";
function toggle_output_size () {
    if (output_window_size === "small") {
        document.getElementById('out_win_div').style.height ='400px';
        document.getElementById('output_win_txt').style.height ='335px';
        document.getElementById('code_txt_div').style.bottom = '400px';
        document.getElementById('output_window_toggler').innerHTML = "|";
        document.getElementById('output_window_toggler').title = "Rapetisser";
        output_window_size = "big";
    } else {
        document.getElementById('out_win_div').style.height ='190px';
        document.getElementById('output_win_txt').style.height ='125px';
        document.getElementById('code_txt_div').style.bottom = '190px';
        document.getElementById('output_window_toggler').innerHTML = "~";
        document.getElementById('output_window_toggler').title = "Agrandir";
        output_window_size = "small";
    }
}

</script>

<script src="mathcortex/mode-javascript.js"></script>
</head>

<body onload="on_load_page();">
<div id="bodyContent">

<div id="header_div">Calculatrice pour Introduction à l'algèbre linéaire <small><small>[adaptée de
    <a class="external" href="http://www.mathcortex.com">MathCortex Online Computing]</small></small></a>
</div>

<div style="min-width:800px;width:98%;position:absolute;top:60px;bottom:0px">


<div style="width: 15%;" id="leftcol">

<a class="btn infolink " href="#" style="float:right;margin-top:-10px;padding-left:12px;padding-right:0" onclick="toggle_help_col();"><span id="toggle_help_span" class="icon gray small" data-icon="}">}</span></a>

<div id="leftcontent">
<a class="infolink " href="#"><span class="icon gray small" style="top:-14px" data-icon="}">}</span>Description</a>
<div id="help_tab" class="expandable">
<p>Cette calculatrice a été adaptée de <a href="http://www.mathcortex.com">mathcortex.com</a> par
    André Roberge avec la permission de Gorkem Gencay,
    créateur de MathCortex.  Utilisant <a href="http://www.numericjs.com/">Numeric Javascript</a>,
    elle permet de faire plusieurs calculs matriciels vus dans
    un cours d'introduction à l'algèbre linéaire. Les calculs sont normalement
    sauvegardés automatiquement sur votre ordinateur.
</p>
<p>Chaque instruction doit se terminer par un point virgule (;).</p>
<p>Tout texte qui suit // jusqu'à la fin d'une ligne
    est un commentaire, ignoré par la calculatrice</p>
</div>
<br><br><a class="small infolink" href="#"><span class="icon gray small" style="top:-14px" data-icon="}">}</span>Fonctions</a>
<div class="expandable">
    <h6 class="funcname">[...]</h6>La création d'une matrice se fait en séparant les
    valeurs sur une ligne par des virgules, et en séparant les lignes par
    des points-virgules. <br>X = [1, 2, 3; 4, 5, 6]<br>
    <h6 class="funcname">print</h6>"Imprime" la valeur d'une variable X<br>print(X)<br>
	<h6 class="funcname">inv</h6>Inverse d'une matrice<br>Y = inv(X)<br>
	<h6 class="funcname">det</h6>Déterminant d'une matrice<br>d = det(X)<br>
	<h6 class="funcname">trans</h6>Transposée d'une matrice<br>Y = trans(X)<br>
    <h6 class="funcname">resoudre</h6>Résout un système d'équations linéaires<br>x = resoudre(A,b)<br>
    <h6 class="funcname">identite</h6>Crée une matrice identité n par n<br>M = identite(n)<br>
    <h6 class="funcname">zeros</h6>Crée une matrice remplie de zéros<br>X = zeros(n)<br>X = zeros(m,n)<br>
    <h6 class="funcname">uns</h6>Crée une matrice remplie de 1<br>X = uns(n)<br>X = uns(m,n)<br>
    Pour obtenir une autre valeur partout, il suffit de multiplier la matrice par un scalaire. <br>
    <h6 class="funcname">rand</h6>Crée une matrice dont les chaque coefficient est un nombre aléatoire
    différent entre 0 et 1<br>X = rand(n)<br>X = rand(m,n)<br>
	<h6 class="funcname">Fonctions élémentaires</h6>abs(x), acos(x), asin(x), atan(x),
atan2(y,x), ceil(x), cos(x), exp(x), floor(x), log(x), max(x,y,z,...,n),
 min(x,y,z,...,n), pow(x,y), random(), round(x), sin(x), sqrt(x), tan(x)<br>
	<h6 class="funcname">somme</h6>Somme sur tous les éléments<br>s = somme(X)<br>
	<h6 class="funcname">linspace</h6>Génère un vecteur dont les coefficients sont linéairement
    espacés<br>y = linspace(a,b)<br>y = linspace(a,b,n)<br>
	<h6 class="funcname">propre</h6>Détermine les valeurs et les vecteurs propres<br>valeurs = propre(M)
    <br>[valeurs vecteurs] = propre(M)<br>
	<h6 class="funcname">nb_cols, nb_lignes</h6>Obtient le nombre de lignes ou
    colonnes d'une matrice<br>c = nb_cols(X)<br>l = nb_lignes(X)<br>
    <h6 class="funcname">svd</h6>Décomposition en valeurs singulières<br>X = svd(X)<br>[U S V] = svd(X)<br>

</div>

<br><br><a class="small infolink" href="#"><span class="icon gray small" style="top:-14px" data-icon="}">}</span>Exemples</a>
		<div id="examples_tab" class="expandable">
		<pre id="ex1">a = identite(5);

b = zeros(5, 4);
c = uns(3, 5);

r = rand(3, 5);

l = linspace(1, 36, 12);

e = [1, 3; 2, -2];</pre>
		<pre id="ex3">a = identite(2);

b = [1, 3; 2, -2];

c = [1, 2; 3, 4];

d = b * c + a;

e = b ./ c;

f = det(d);</pre>
		<pre id="ex4">b = [1, 3, 4; 2, -2, 2; sin(pi / 3) cos(pi / 3) 1];

d = [ -1, 1, -2 ; 2, -2, 6 ; 7, 3, -3];

d[0, :] = d[2, :];

e = 2 * d - 4 * b - 1;
</pre>
		<pre id="ex5">M = rand(100, 100);
T = trans(M);
S = inv(T);</pre>
		résoudre<pre id="ex_linsolve">A = [5,-6, 1;
     2, 4, 0;
     0, 5, 6];

b = [-1; 2; 3];

x = resoudre(A, b);

print(A * x - b);

/// Autre exemple
C = rand(100, 100);
d = rand(100, 1) + 3;

y = resoudre(C, d);

err = C * y - d;

print(trans(err) * err);
</pre>

		Svd<pre id="ex_svd1">M  = [2.655,  0.3959, 2.044;
      0.9232, 3.959,  1.681;
      2.488,  2.897,  1.076];

[u s v] = svd(M);

print(M - u * diag(s) * trans(v));
</pre>
		Valeurs et vecteur propres<pre id="ex_eig1">M  = [2.655,  0.3959, 2.044;
      0.9232, 3.959,  1.681;
      2.488,  2.897,  1.076];

[valeur vecteur] = propre(M);

v1 = vecteur[:,0];
print(M * v1 - valeur[0] * v1);

v2 = vecteur[:,1];
print(M * v2 - valeur[1] * v2);

v3 = vecteur[:,2];
print(M * v3 - valeur[2] * v3);</pre>



Fonctions
<pre id="ex_plot_funcs1">// simple fonction
function addition(a, b)
{
  r = a + b;
  return r;
}

// fonction récursive
function f(a)
{
  print(a);
  a = a - 1;
  if (a &gt; 0)
  {
    f(a);
  }

  return 0;
}

// démonstration
f(20);

y = addition(55, 22);</pre>

</div>

<br><br>

</div>
</div>


<div style="width: 52%;" id="middlecol">


<div id="code_txt_div" style="left:0px;right:0px;position:absolute;top:0px;bottom:190px;padding-right:12px;padding-left:8px;margin:0 12px 0 8px">


<div class="tabContainer" style="position:absolute;top:0;bottom:0px;left:0;right:0;">
<div id="pagesToolbarCont" class="tabs"><ul><li class="tabActiveHeader3" id="pages_btn0" style="width:610px" title="new 1" onclick="SelectPage(0)">Page 1<img class="" src="mathcortex/page_white_error.png" style="position:absolute;right:20px;" title="File is stored on browser cache with best effort. You can login and store at server for reliable storage" height="14" width="14"><img class="" src="mathcortex/delete-icon.png" style="position:absolute;right:5px;" onclick="RemovePage(0)" height="12" width="12"></li><button class="" onclick="AddNewPage()">+</button></ul></div>
<div style="position:absolute;height:5px;left:5px;right:4px;border:1px solid #CCC;border-bottom:0;background-color:#f4f4f4;z-index:2"></div>
<div class="whiteGradient" style="padding:4px;position:absolute;left:5px;right:4px;height:24px;top:35px; background-color:#EEEEEE;margin-left:0px;border:1px solid #CCC;border-top:0">
<button class="btn small" style="background-color:white" onclick="parse_m(ace_editor.getSession().getValue());asm_execute(update_editor);"><span class="icon red" data-icon="}">}</span>Calculer</button>

<textarea id="view_gen_code" class="header_link_exp" style="width:350px;background-color: white;margin-top:28px;"></textarea>
<select style="float:right;font-size: 13px;width:150px;margin-left:10px;" onchange="OpenPageText(on_tutorial_change(this.options[this.selectedIndex].value));">
			<option value="" selected="selected"> - Exemples - </option>
			<option value="bas_exp">Simple calcul numérique</option>
			<option value="ex1">Création de matrice</option>
			<option value="ex4">Opérations sur les matrices</option>
			<option value="ex3">Opérations sur les matrices et déterminant</option>
			<option value="ex_linsolve">Systèmes d'équations linéaires</option>
			<option value="ex_svd1">Décomposition en valeurs singulières</option>
			<option value="ex_eig1">Vecteurs et valeurs propres</option>
			<option value="ex_plot_funcs1">Fonctions</option>
		</select>
</div>
<div class="header_link_exp" id="status" style="width:auto;min-width:140px;top:70px;z-index:3;display:none;height:auto;left:35%;text-align:center;padding:7px 15px">
<span id="statusText"></span>
<img class="" src="mathcortex/delete-icon.png" style="" onclick='$("#status").fadeOut("fast");' height="12" width="12">
</div>
<div style="position:absolute;top:64px;bottom:4px;left:5px;right:4px">
<textarea id="code_txt" style="border: 5px #0;width:100%;height:100%;display:none" wrap="off" spellcheck="false">a = 4 + sin(pi / 6) * cos(pi / 4);</textarea>
<div style="width:100%;height:100%;padding-top:3px;margin-top:3px;border:1px solid #ccc">
<pre class=" ace_editor ace_nobold ace-tm ace_focus" id="editor" style="border:0px;padding:0;width:100%;height:100%;"><textarea style="bottom: 321px; height: 15px; width: 7.2px; right: 655.8px;" spellcheck="false" wrap="off" class="ace_text-input"></textarea></pre></div>

</div>
</div>


<span id="share_btn" title="Hyperlien pour cette page" class="icon" style="cursor:pointer;position:absolute;top: 66px;left: auto;right: 30px;font-size:16px;color: dimgray;" onclick="$('#link_input').val( location.protocol + '//' + location.host + location.pathname + '#cmd=run&amp;code=' + encodeURIComponent(codeUri(ace_editor.getSession().getValue())));toggle_anim(null, $('#link_win'));$('#link_input').focus();$('#link_input').select();">_
</span>
<div id="link_win" class="bordersmooth" style="padding:6px;width:500px;height:40px;overflow:auto;position:absolute;top: 84px;left: auto;right: 32px;font-size:11px;background-color: #E8E8FF;border: 1px solid #bbb;box-shadow: 2px 3px 4px #4d4c47;display:none;z-index:1">
Hyperlien pour cette page
<input id="link_input" style="width:98%" type="text">
</div>

</div>

<div id="out_win_div" style="height:190px;left:5px;right:0px;position:absolute;bottom:0px;padding-right:12px;padding-left:8px;">

<pre title="Résultats" id="output_win_txt" class="code_table_div" style="white-space:pre;word-wrap:normal; box-shadow: 0px 0px 0px #888888;left:0;right:10px;width:auto;height:125px;margin-bottom:0px;margin-top:10px;padding:4px">

</pre>
<span class="icon red" title="Effacer tout" style="cursor:pointer;position:absolute;top: 6px;left: auto;right: 32px;font-size:16px;" onclick="document.getElementById('output_win_txt').innerHTML = '\n'" data-icon="!">!</span>
<span class="icon" id="output_window_toggler" title="Agrandir" style="cursor:pointer;position:absolute;top: 4px;left: auto;right: 60px;font-size:18px;color: dimgray;" onclick="toggle_output_size()">~</span>
<div style="width: 100%;">
	<div style="width: 20px; float: left;margin-top:4px;height:24px;">&gt;&gt;</div>
	<div style="margin-left: 24px; margin-right: 32px;">
		<textarea id="command_win" placeholder="Entrez une commande ici comme (143+656)*(5-2)" style="/*background-color : LightYellow*/;width:100%;box-shadow: 2px 2px 1px #888888;height:32px;margin-top:0px;" rows="1" cols="50"></textarea>
	</div>
</div>
</div>

</div>

<div id="rightcol">
<div style="height:52%;position:relative"><br>


<div id="var_table_cont" class="code_table_div" style="position:absolute;top:42px;bottom:20px;background-color:white"></div>
<div id="workspace_cont" class="code_table_div" style="position:absolute;top:71px;bottom:20px;display:none;background-color:white"></div>
Variables
<button id="var_clear_all" class="small white" onclick="comp_clear_all();update_editor();"><span class="icon red small" data-icon="!">!</span>Effacer tout</button>

</div>
<br>
<div style="height:43%;position:relative">
Historique
<button class="small white" onclick="hist_clear_all();"><span class="icon red small" data-icon="!">!</span>Effacer tout</button>
<br>
<div id="hist_div" class="code_table_div" style="position:absolute;top:25px;bottom:25px;width:100%">
<textarea id="hist_txt" rows="1" style="display:none"></textarea>
<table id="hist_table" style="white-space:nowrap;"><tbody>
</tbody></table>
</div>
</div>
</div>


</div>


<div id="name_win_modal" style="display:none;opacity:0.7;filter: alpha(opacity=70);background-color:gray;position:absolute;top:0;bottom:0;left:0;right:0;z-index:10">
</div>

</div>


</body></html>
